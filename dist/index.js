var g=(e,n)=>()=>(n||e((n={exports:{}}).exports,n),n.exports);var d=g((W,u)=>{var w=require("@actions/http-client"),k=require("@actions/github"),a=require("@actions/core"),v=require("fs"),_=require("path");async function $(){try{let e=q(),n=a.getInput("change-log-path"),r=process.env.SLACK_WEBHOOK_URL,o=b(n),t=C(o)[0],s=N(t);S(s,e),await A(s,r)}catch(e){console.error(e),a.setFailed(e.message)}}function b(e){return v.readFileSync(_.resolve(process.cwd(),e),"utf8")}function q(){let e=a.getInput("service-name");return e||k.context.repo.repo.split("-").join(" ").split(" ").map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" ")}async function A(e,n){try{let o=await new w.HttpClient().post(n,JSON.stringify({blocks:e}));o.message.statusCode!==200&&a.setFailed(`Request failed with status code ${o.message.statusCode}`),o.message.destroy()}catch(r){a.setFailed(r.message)}}function C(e){let n=[],r=e.split(`
`),o=[];for(let t of r){if(t.startsWith("# [")||t.startsWith("## [")){let s=t.match(/# \[(.*?)\]/)[1],i=t.match(/\d{4}-\d{2}-\d{2}/)[0],h=t.match(/\((.*?)\)/)[1];o.push({type:"Header",raw:t,version:s,date:i,url:h})}if(t.match(/^# \d+.\d+.\d+/)){let s=t.match(/# (.*?) /)[1],i=t.match(/\d{4}-\d{2}-\d{2}/)[0];o.push({type:"Header",raw:t,version:s,date:i})}if(t.startsWith("### ")){let s=t.replace("### ","");o.push({type:"Section",raw:t,title:s})}if(t.startsWith("* ")){let s=t.replaceAll("**","").replaceAll("* ","").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;"),i=s,h=s.match(/\[(.*?)\]\((.*?)\)/g),l=[];for(let p of h??[]){let m=p.match(/\((.*?)\)/)[1],y=p.match(/\[(.*?)\]/)[1],[f,x]=i.split(p);l.push({type:"Text",text:f}),l.push({type:"Link",raw:p,url:m,text:y}),i=x}l.push({type:"Text",text:i}),o.push({type:"Item",raw:t,sections:l})}}let c={header:{version:"",date:"",url:""},sections:[]};for(let t=0;t<o.length;t++){let s=o[t];if(s.type==="Header"&&(c={header:{version:s.version,date:s.date,url:s.url},sections:[]},n.push(c)),s.type==="Section"){let i={title:s.title,items:[]};c.sections.push(i)}s.type==="Item"&&c.sections[c.sections.length-1].items.push({item:s.item,sections:s.sections})}return n}function N(e){let n=[];e.header.url?n.push({type:"section",text:{type:"mrkdwn",text:`<${e.header.url}|${e.header.version}> (${e.header.date})`}}):n.push({type:"section",text:{type:"mrkdwn",text:`${e.header.version} (${e.header.date})`}});for(let r of e.sections)n.push({type:"rich_text",elements:[{type:"rich_text_section",elements:[{type:"text",text:`${r.title}
`,style:{bold:!0}}]},{type:"rich_text_list",style:"bullet",elements:[...r.items.map(o=>({type:"rich_text_section",elements:[...o.sections.map(c=>{if(c.type==="Text")return{type:"text",text:c.text};if(c.type==="Link")return{type:"link",url:c.url,text:c.text}})]}))]}]});return n}function S(e,n){let r=[{type:"header",text:{type:"plain_text",text:`Release Note - ${n}`}}];e.unshift(...r)}u.exports={run:$}});var{run:H}=d();H();
